<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Test - Enhanced Markdown Viewer</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div id="container">
        <div id="markdown-content">
            <h1>Simple Test Page</h1>
            <p>このページでツールバーとCSSが正しく読み込まれているかテストします。</p>
            
            <h2>セクション 1</h2>
            <p>目次機能のテスト用セクションです。</p>
            
            <h2>セクション 2</h2>
            <p>もう一つのセクションです。</p>
            
            <h3>サブセクション 2.1</h3>
            <p>階層テスト用のサブセクションです。</p>
        </div>
    </div>
    
    <script src="lib/marked.min.js"></script>
    <script src="lib/mermaid.min.js"></script>
    <script src="js/toc-generator.js"></script>
    <script src="js/theme-manager.js"></script>
    <script src="js/search-engine.js"></script>
    <script src="js/toolbar.js"></script>
    
    <script>
        console.log('Simple test started');
        
        // 段階的に機能をテスト
        let attempts = 0;
        const maxAttempts = 50;
        
        const testClasses = () => {
            attempts++;
            console.log(`Step ${attempts}: Testing class availability...`);
            console.log('Toolbar:', typeof window.Toolbar);
            console.log('SearchEngine:', typeof window.SearchEngine);
            console.log('ThemeManager:', typeof window.ThemeManager);
            console.log('TOCGenerator:', typeof window.TOCGenerator);
            
            if (typeof window.Toolbar !== 'undefined') {
                console.log('✅ All classes are available');
                
                try {
                    console.log('Step 2: Creating Toolbar instance');
                    window.testToolbar = new window.Toolbar(document.body);
                    console.log('✅ Toolbar created successfully');
                    
                    // ツールバー要素の確認
                    setTimeout(() => {
                        const toolbar = document.querySelector('.main-toolbar');
                        if (toolbar) {
                            console.log('✅ Toolbar element found in DOM');
                            console.log('Toolbar style:', window.getComputedStyle(toolbar).position);
                        } else {
                            console.log('❌ Toolbar element not found in DOM');
                        }
                    }, 1000);
                    
                } catch (error) {
                    console.error('❌ Error creating Toolbar:', error);
                }
            } else if (attempts < maxAttempts) {
                console.log(`Classes not ready, retrying... (${attempts}/${maxAttempts})`);
                setTimeout(testClasses, 100);
            } else {
                console.error('❌ Timeout: Classes never became available');
            }
        };
        
        setTimeout(testClasses, 500);
        
        // CSS読み込み確認
        setTimeout(() => {
            const testElement = document.createElement('div');
            testElement.className = 'main-toolbar';
            testElement.style.position = 'absolute';
            testElement.style.top = '-1000px';
            document.body.appendChild(testElement);
            
            const computedStyle = window.getComputedStyle(testElement);
            console.log('CSS Test - toolbar position:', computedStyle.position);
            console.log('CSS Test - toolbar background:', computedStyle.backgroundColor);
            
            document.body.removeChild(testElement);
        }, 1000);
    </script>
</body>
</html>