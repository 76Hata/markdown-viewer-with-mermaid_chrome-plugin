<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Test - Markdown Viewer with Mermaid</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .metrics { background: #f5f5f5; padding: 10px; margin: 10px 0; }
        .result { font-weight: bold; }
        .improvement { color: green; }
        .degradation { color: red; }
    </style>
</head>
<body>
    <h1>ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆçµæœ</h1>
    
    <div class="test-section">
        <h2>åˆæœŸèª­ã¿è¾¼ã¿æ™‚é–“æ¸¬å®š</h2>
        <div id="load-time-results" class="metrics">
            <p>æ¸¬å®šä¸­...</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚µã‚¤ã‚ºæ¯”è¼ƒ</h2>
        <div class="metrics">
            <h3>ä¿®æ­£å‰ï¼ˆmanifest.jsonåŒæœŸèª­ã¿è¾¼ã¿ï¼‰</h3>
            <ul>
                <li>mermaid.min.js: 2.8MB</li>
                <li>jspdf.umd.min.js: 356KB</li>
                <li>html2canvas.min.js: 195KB</li>
                <li>marked.min.js: 52KB</li>
                <li><strong>åˆè¨ˆ: 3.4MB</strong></li>
            </ul>
            
            <h3>ä¿®æ­£å¾Œï¼ˆé…å»¶èª­ã¿è¾¼ã¿ï¼‰</h3>
            <ul>
                <li>marked.min.js: 52KBï¼ˆå³åº§èª­ã¿è¾¼ã¿ï¼‰</li>
                <li>mermaid.min.js: 2.8MBï¼ˆå›³è¡¨æ¤œå‡ºæ™‚ã®ã¿ï¼‰</li>
                <li>jspdf.umd.min.js: 356KBï¼ˆPDFç”Ÿæˆæ™‚ã®ã¿ï¼‰</li>
                <li>html2canvas.min.js: 195KBï¼ˆPDFç”Ÿæˆæ™‚ã®ã¿ï¼‰</li>
                <li><strong>åˆæœŸèª­ã¿è¾¼ã¿: 52KB ï¼ˆç´„98%å‰Šæ¸›ï¼‰</strong></li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h2>ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡æ¸¬å®š</h2>
        <div id="memory-results" class="metrics">
            <p>æ¸¬å®šä¸­...</p>
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š Mermaidãƒ†ã‚¹ãƒˆå›³è¡¨</h2>
        <p>ä»¥ä¸‹ã®å›³è¡¨ã§Mermaidé…å»¶èª­ã¿è¾¼ã¿ã‚’ãƒ†ã‚¹ãƒˆ:</p>
        
        ```mermaid
        graph TD
            A[ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹] --> B{Markdownå›³è¡¨ã‚ã‚Šï¼Ÿ}
            B -->|No| C[è»½é‡èª­ã¿è¾¼ã¿å®Œäº†]
            B -->|Yes| D[Mermaidå‹•çš„èª­ã¿è¾¼ã¿]
            D --> E[å›³è¡¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°]
            E --> F[å®Œäº†]
        ```
        
        <div class="metrics">
            <p id="mermaid-test-result">Mermaidèª­ã¿è¾¼ã¿çŠ¶æ³ã‚’ç¢ºèªä¸­...</p>
        </div>
    </div>

    <script>
        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        const performanceTests = {
            startTime: performance.now(),
            
            measureLoadTime() {
                const loadTime = performance.now() - this.startTime;
                document.getElementById('load-time-results').innerHTML = `
                    <p><strong>ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚é–“: ${loadTime.toFixed(2)}ms</strong></p>
                    <p>å¾“æ¥æ¯”è¼ƒ: é…å»¶èª­ã¿è¾¼ã¿ã«ã‚ˆã‚ŠåˆæœŸè¡¨ç¤ºãŒé«˜é€ŸåŒ–</p>
                `;
            },
            
            measureMemory() {
                if (performance.memory) {
                    const memory = performance.memory;
                    document.getElementById('memory-results').innerHTML = `
                        <p><strong>ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</strong></p>
                        <ul>
                            <li>ä½¿ç”¨æ¸ˆã¿JSãƒ’ãƒ¼ãƒ—: ${(memory.usedJSHeapSize / 1024 / 1024).toFixed(2)}MB</li>
                            <li>ç·JSãƒ’ãƒ¼ãƒ—: ${(memory.totalJSHeapSize / 1024 / 1024).toFixed(2)}MB</li>
                            <li>JSãƒ’ãƒ¼ãƒ—åˆ¶é™: ${(memory.jsHeapSizeLimit / 1024 / 1024).toFixed(2)}MB</li>
                        </ul>
                        <p class="improvement">é…å»¶èª­ã¿è¾¼ã¿ã«ã‚ˆã‚ŠåˆæœŸãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’å¤§å¹…å‰Šæ¸›</p>
                    `;
                } else {
                    document.getElementById('memory-results').innerHTML = `
                        <p>ãƒ¡ãƒ¢ãƒªæƒ…å ±ã¯éå¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶ã§ã™</p>
                    `;
                }
            },
            
            checkMermaidLoading() {
                const hasMermaid = typeof mermaid !== 'undefined';
                const hasLibraryLoader = typeof LibraryLoader !== 'undefined';
                
                document.getElementById('mermaid-test-result').innerHTML = `
                    <ul>
                        <li>Mermaidèª­ã¿è¾¼ã¿çŠ¶æ³: ${hasMermaid ? 'âœ… èª­ã¿è¾¼ã¿æ¸ˆã¿' : 'âšª æœªèª­ã¿è¾¼ã¿ï¼ˆæ­£å¸¸ï¼‰'}</li>
                        <li>LibraryLoaderåˆ©ç”¨å¯èƒ½: ${hasLibraryLoader ? 'âœ… Yes' : 'âŒ No'}</li>
                        <li>å‹•çš„èª­ã¿è¾¼ã¿çŠ¶æ³: ${hasMermaid ? 'å›³è¡¨æ¤œå‡ºã«ã‚ˆã‚Šè‡ªå‹•èª­ã¿è¾¼ã¿å®Œäº†' : 'å›³è¡¨æœªæ¤œå‡ºã®ãŸã‚èª­ã¿è¾¼ã¿ã‚¹ã‚­ãƒƒãƒ—'}</li>
                    </ul>
                `;
            }
        };
        
        // DOMContentLoadedå¾Œã«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                performanceTests.measureLoadTime();
                performanceTests.measureMemory();
                performanceTests.checkMermaidLoading();
            }, 100);
        });
        
        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ç”¨ãƒãƒ¼ã‚«ãƒ¼
        performance.mark('test-page-start');
        
        window.addEventListener('load', () => {
            performance.mark('test-page-complete');
            performance.measure('test-page-load-time', 'test-page-start', 'test-page-complete');
            
            const measure = performance.getEntriesByName('test-page-load-time')[0];
            console.log('ğŸ“Š Performance Test Results:');
            console.log(`Total load time: ${measure.duration.toFixed(2)}ms`);
        });
    </script>
</body>
</html>